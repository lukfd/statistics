library(mFilter)
fargo <- read.csv("C:/Users/Luca/Desktop/SPRING2021/Statistical Research/Correct Dataset/fargo.csv", encoding="UTF-8")
grand <- read.csv("C:/Users/Luca/Desktop/SPRING2021/Statistical Research/Correct Dataset/grand.csv", encoding="UTF-8")
# Discharge
grand_discharge_ts <- ts(grand$discharge,
start = 2014,
end = 2020,
frequency = 365)
fargo_discharge_ts <- ts(fargo$discharge,
start = 2014,
end = 2020,
frequency = 365)
# Average Temperature
grand_temp_ts <- ts(grand$avg.temp,
start = 2014,
end = 2020,
frequency = 365)
fargo_temp_ts <- ts(fargo$avg.temp,
start = 2014,
end = 2020,
frequency = 365)
# Evapotranspiration
grand_pen_ts <- ts(grand$penman.pet,
start = 2014,
end = 2020,
frequency = 365)
fargo_pen_ts <- ts(fargo$penman.pet,
start = 2014,
end = 2020,
frequency = 365)
# Rainfall
grand_rainfall_ts <- ts(grand$rainfall,
start = 2014,
end = 2020,
frequency = 365)
fargo_rainfall_ts <- ts(fargo$rainfall,
start = 2014,
end = 2020,
frequency = 365)
# Snow Depth
grand_snow_ts <- ts(grand$snow.depth,
start = 2014,
end = 2020,
frequency = 365)
fargo_snow_ts <- ts(fargo$snow.depth,
start = 2014,
end = 2020,
frequency = 365)
# Top Soil temperature
grand_top_soil_ts <- ts(grand$top.soil.temp,
start = 2014,
end = 2020,
frequency = 365)
fargo_top_soil_ts <- ts(fargo$top.soil.temp,
start = 2014,
end = 2020,
frequency = 365)
plot(cbind(grand_discharge_ts,grand_top_soil_ts,grand_rainfall_ts), main = "Discharge and Top Soil temperature")
plot(cbind(fargo_discharge_ts,fargo_top_soil_ts,fargo_rainfall_ts), main = "Discharge and Top Soil temperature")
grand_discharge_fit <- stl(grand_discharge_ts, s.window="period")
plot(grand_discharge_ts_fit)
# Grand
grand_pen_fit <- stl(grand_pen_ts, s.window="period")
grand_rainfall_fit <- stl(grand_rainfall_ts, s.window="period")
grand_snow_fit <- stl(grand_snow_ts, s.window="period")
grand_temp_fit <- stl(grand_temp_ts, s.window="period")
grand_top_soil_fit <- stl(grand_top_soil_ts, s.window="period")
# Fargo
fargo_discharge_fit <- stl(fargo_discharge_ts, s.window="period")
fargo_pen_fit <- stl(fargo_pen_ts, s.window="period")
fargo_rainfall_fit <- stl(fargo_rainfall_ts, s.window="period")
fargo_snow_fit <- stl(fargo_snow_ts, s.window="period")
fargo_temp_fit <- stl(fargo_temp_ts, s.window="period")
fargo_top_soil_fit <- stl(fargo_top_soil_ts, s.window="period")
head(grand_discharge_fit$time.series)
plot(grand_discharge_fit$time.series[,"trend"])
acf(grand_discharge_fit$time.series[,"trend"])
plot(grand_discharge_fit$time.series[,"remainder"])
acf(grand_discharge_fit$time.series[,"remainder"])
grand_discharge_fit$time.series[,"remainder"]
grand_discharge_fit = grand_discharge_fit$time.series[,"remainder"]
# Grand
grand_discharge_fit = grand_discharge_fit$time.series[,"remainder"]
# Grand
grand_discharge_fit = grand_discharge_fit$time.series[,"remainder"]
# Grand
grand_discharge_fit = grand_discharge_fit$time.series[,"remainder"]
knitr::opts_chunk$set(echo = TRUE)
library(forcats)
library(lubridate)
library(ggplot2)
library(vars)
library(mFilter)
fargo <- read.csv("C:/Users/Luca/Desktop/SPRING2021/Statistical Research/Correct Dataset/fargo.csv", encoding="UTF-8")
grand <- read.csv("C:/Users/Luca/Desktop/SPRING2021/Statistical Research/Correct Dataset/grand.csv", encoding="UTF-8")
# Discharge
grand_discharge_ts <- ts(grand$discharge,
start = 2014,
end = 2020,
frequency = 365)
fargo_discharge_ts <- ts(fargo$discharge,
start = 2014,
end = 2020,
frequency = 365)
# Average Temperature
grand_temp_ts <- ts(grand$avg.temp,
start = 2014,
end = 2020,
frequency = 365)
fargo_temp_ts <- ts(fargo$avg.temp,
start = 2014,
end = 2020,
frequency = 365)
# Evapotranspiration
grand_pen_ts <- ts(grand$penman.pet,
start = 2014,
end = 2020,
frequency = 365)
fargo_pen_ts <- ts(fargo$penman.pet,
start = 2014,
end = 2020,
frequency = 365)
# Rainfall
grand_rainfall_ts <- ts(grand$rainfall,
start = 2014,
end = 2020,
frequency = 365)
fargo_rainfall_ts <- ts(fargo$rainfall,
start = 2014,
end = 2020,
frequency = 365)
# Snow Depth
grand_snow_ts <- ts(grand$snow.depth,
start = 2014,
end = 2020,
frequency = 365)
fargo_snow_ts <- ts(fargo$snow.depth,
start = 2014,
end = 2020,
frequency = 365)
# Top Soil temperature
grand_top_soil_ts <- ts(grand$top.soil.temp,
start = 2014,
end = 2020,
frequency = 365)
fargo_top_soil_ts <- ts(fargo$top.soil.temp,
start = 2014,
end = 2020,
frequency = 365)
plot(cbind(grand_discharge_ts,grand_top_soil_ts,grand_rainfall_ts), main = "Discharge and Top Soil temperature")
plot(cbind(fargo_discharge_ts,fargo_top_soil_ts,fargo_rainfall_ts), main = "Discharge and Top Soil temperature")
grand_discharge_fit <- stl(grand_discharge_ts, s.window="period")
plot(grand_discharge_ts_fit)
# Grand
grand_pen_fit <- stl(grand_pen_ts, s.window="period")
grand_rainfall_fit <- stl(grand_rainfall_ts, s.window="period")
grand_snow_fit <- stl(grand_snow_ts, s.window="period")
grand_temp_fit <- stl(grand_temp_ts, s.window="period")
grand_top_soil_fit <- stl(grand_top_soil_ts, s.window="period")
# Fargo
fargo_discharge_fit <- stl(fargo_discharge_ts, s.window="period")
fargo_pen_fit <- stl(fargo_pen_ts, s.window="period")
fargo_rainfall_fit <- stl(fargo_rainfall_ts, s.window="period")
fargo_snow_fit <- stl(fargo_snow_ts, s.window="period")
fargo_temp_fit <- stl(fargo_temp_ts, s.window="period")
fargo_top_soil_fit <- stl(fargo_top_soil_ts, s.window="period")
head(grand_discharge_fit$time.series)
plot(grand_discharge_fit$time.series[,"trend"])
acf(grand_discharge_fit$time.series[,"trend"])
plot(grand_discharge_fit$time.series[,"remainder"])
acf(grand_discharge_fit$time.series[,"remainder"])
# Grand
grand_discharge_fit = grand_discharge_fit$time.series[,"remainder"]
grand_pen_fit = grand_pen_fit$time.series[,"remainder"]
grand_rainfall_fit = grand_rainfall_fit$time.series[,"remainder"]
grand_snow_fit = grand_snow_fit$time.series[,"remainder"]
grand_temp_fit = grand_temp_fit$time.series[,"remainder"]
grand_top_soil_fit = grand_top_soil_fit$time.series[,"remainder"]
# Fargo
fargo_discharge_fit = fargo_discharge_fit$time.series[,"remainder"]
fargo_pen_fit = fargo_pen_fit$time.series[,"remainder"]
fargo_rainfall_fit = fargo_rainfall_fit$time.series[,"remainder"]
fargo_snow_fit = fargo_snow_fit$time.series[,"remainder"]
fargo_temp_fit = fargo_temp_fit$time.series[,"remainder"]
fargo_top_soil_fit = fargo_top_soil_fit$time.series[,"remainder"]
# Selection of the variables
grand_bind_dis_top <- cbind(grand_discharge_fit, grand_top_soil_fit)
colnames(grand_bind_dis_top) <- c("discharge", "soil")
# Set up the analysis
grand_model <- VARselect(grand_bind_dis_top, lag.max = 12, type = "const")
grand_model$selection
# Selection of the variables
grand_bind_dis_top <- cbind(grand_discharge_fit, grand_top_soil_fit)
colnames(grand_bind_dis_top) <- c("discharge", "soil")
# Set up the analysis
grand_model <- VARselect(grand_bind_dis_top, lag.max = 12, type = "const")
grand_model$selection
grand_est <- VAR(grand_bind_dis_top, p = 6, type = "const", season = NULL,
exog = NULL)
summary(grand_est)
grand_serial <- serial.test(grand_est, lags.pt = 6, type = "PT.asymptotic")
grand.serial
grand_serial <- serial.test(grand_est, lags.pt = 6, type = "PT.asymptotic")
grand_serial
plot(bv.serial, names = "discharge")
grand_serial <- serial.test(grand_est, lags.pt = 6, type = "PT.asymptotic")
grand_serial
plot(grand_serial, names = "discharge")
plot(grand_serial, names = "soil")
grand_serial <- serial.test(grand_est, lags.pt = 12, type = "PT.asymptotic")
grand_serial
plot(grand_serial, names = "discharge")
plot(grand_serial, names = "soil")
grand_arch <- arch.test(grand_est, lags.multi = 12, multivariate.only = TRUE)
grand_arch
grand_norm <- normality.test(grand_est, multivariate.only = TRUE)
grand_norm
grand_cusum <- stability(grand_est, type = "OLS-CUSUM")
plot(grand_cusum)
knitr::opts_chunk$set(echo = TRUE)
library(forcats)
library(lubridate)
library(ggplot2)
library(vars)
library(mFilter)
fargo <- read.csv("C:/Users/Luca/Desktop/SPRING2021/Statistical Research/Correct Dataset/fargo.csv", encoding="UTF-8")
grand <- read.csv("C:/Users/Luca/Desktop/SPRING2021/Statistical Research/Correct Dataset/grand.csv", encoding="UTF-8")
# Discharge
grand_discharge_ts <- ts(grand$discharge,
start = 2014,
end = 2020,
frequency = 365)
fargo_discharge_ts <- ts(fargo$discharge,
start = 2014,
end = 2020,
frequency = 365)
# Average Temperature
grand_temp_ts <- ts(grand$avg.temp,
start = 2014,
end = 2020,
frequency = 365)
fargo_temp_ts <- ts(fargo$avg.temp,
start = 2014,
end = 2020,
frequency = 365)
# Evapotranspiration
grand_pen_ts <- ts(grand$penman.pet,
start = 2014,
end = 2020,
frequency = 365)
fargo_pen_ts <- ts(fargo$penman.pet,
start = 2014,
end = 2020,
frequency = 365)
# Rainfall
grand_rainfall_ts <- ts(grand$rainfall,
start = 2014,
end = 2020,
frequency = 365)
fargo_rainfall_ts <- ts(fargo$rainfall,
start = 2014,
end = 2020,
frequency = 365)
# Snow Depth
grand_snow_ts <- ts(grand$snow.depth,
start = 2014,
end = 2020,
frequency = 365)
fargo_snow_ts <- ts(fargo$snow.depth,
start = 2014,
end = 2020,
frequency = 365)
# Top Soil temperature
grand_top_soil_ts <- ts(grand$top.soil.temp,
start = 2014,
end = 2020,
frequency = 365)
fargo_top_soil_ts <- ts(fargo$top.soil.temp,
start = 2014,
end = 2020,
frequency = 365)
plot(cbind(grand_discharge_ts,grand_top_soil_ts,grand_rainfall_ts), main = "Grand - Discharge and Top Soil temperature")
plot(cbind(fargo_discharge_ts,fargo_top_soil_ts,fargo_rainfall_ts), main = "Fargo - Discharge and Top Soil temperature")
grand_discharge_fit <- stl(grand_discharge_ts, s.window="period")
plot(grand_discharge_ts_fit, main = "Grand Discharge Decomposition")
knitr::opts_chunk$set(echo = TRUE)
library(forcats)
library(lubridate)
library(ggplot2)
library(vars)
library(mFilter)
fargo <- read.csv("C:/Users/Luca/Desktop/SPRING2021/Statistical Research/Correct Dataset/fargo.csv", encoding="UTF-8")
grand <- read.csv("C:/Users/Luca/Desktop/SPRING2021/Statistical Research/Correct Dataset/grand.csv", encoding="UTF-8")
# Discharge
grand_discharge_ts <- ts(grand$discharge,
start = 2014,
end = 2020,
frequency = 365)
fargo_discharge_ts <- ts(fargo$discharge,
start = 2014,
end = 2020,
frequency = 365)
# Average Temperature
grand_temp_ts <- ts(grand$avg.temp,
start = 2014,
end = 2020,
frequency = 365)
fargo_temp_ts <- ts(fargo$avg.temp,
start = 2014,
end = 2020,
frequency = 365)
# Evapotranspiration
grand_pen_ts <- ts(grand$penman.pet,
start = 2014,
end = 2020,
frequency = 365)
fargo_pen_ts <- ts(fargo$penman.pet,
start = 2014,
end = 2020,
frequency = 365)
# Rainfall
grand_rainfall_ts <- ts(grand$rainfall,
start = 2014,
end = 2020,
frequency = 365)
fargo_rainfall_ts <- ts(fargo$rainfall,
start = 2014,
end = 2020,
frequency = 365)
# Snow Depth
grand_snow_ts <- ts(grand$snow.depth,
start = 2014,
end = 2020,
frequency = 365)
fargo_snow_ts <- ts(fargo$snow.depth,
start = 2014,
end = 2020,
frequency = 365)
# Top Soil temperature
grand_top_soil_ts <- ts(grand$top.soil.temp,
start = 2014,
end = 2020,
frequency = 365)
fargo_top_soil_ts <- ts(fargo$top.soil.temp,
start = 2014,
end = 2020,
frequency = 365)
plot(cbind(grand_discharge_ts,grand_top_soil_ts,grand_rainfall_ts), main = "Grand - Discharge and Top Soil temperature")
plot(cbind(fargo_discharge_ts,fargo_top_soil_ts,fargo_rainfall_ts), main = "Fargo - Discharge and Top Soil temperature")
grand_discharge_fit <- stl(grand_discharge_ts, s.window="period")
plot(grand_discharge_fit, main = "Grand Discharge Decomposition")
# Grand
grand_pen_fit <- stl(grand_pen_ts, s.window="period")
grand_rainfall_fit <- stl(grand_rainfall_ts, s.window="period")
grand_snow_fit <- stl(grand_snow_ts, s.window="period")
grand_temp_fit <- stl(grand_temp_ts, s.window="period")
grand_top_soil_fit <- stl(grand_top_soil_ts, s.window="period")
# Fargo
fargo_discharge_fit <- stl(fargo_discharge_ts, s.window="period")
fargo_pen_fit <- stl(fargo_pen_ts, s.window="period")
fargo_rainfall_fit <- stl(fargo_rainfall_ts, s.window="period")
fargo_snow_fit <- stl(fargo_snow_ts, s.window="period")
fargo_temp_fit <- stl(fargo_temp_ts, s.window="period")
fargo_top_soil_fit <- stl(fargo_top_soil_ts, s.window="period")
head(grand_discharge_fit$time.series)
plot(grand_discharge_fit$time.series[,"trend"])
acf(grand_discharge_fit$time.series[,"trend"])
plot(grand_discharge_fit$time.series[,"remainder"])
acf(grand_discharge_fit$time.series[,"remainder"])
# Grand
grand_discharge_fit = grand_discharge_fit$time.series[,"remainder"]
grand_pen_fit = grand_pen_fit$time.series[,"remainder"]
grand_rainfall_fit = grand_rainfall_fit$time.series[,"remainder"]
grand_snow_fit = grand_snow_fit$time.series[,"remainder"]
grand_temp_fit = grand_temp_fit$time.series[,"remainder"]
grand_top_soil_fit = grand_top_soil_fit$time.series[,"remainder"]
# Fargo
fargo_discharge_fit = fargo_discharge_fit$time.series[,"remainder"]
fargo_pen_fit = fargo_pen_fit$time.series[,"remainder"]
fargo_rainfall_fit = fargo_rainfall_fit$time.series[,"remainder"]
fargo_snow_fit = fargo_snow_fit$time.series[,"remainder"]
fargo_temp_fit = fargo_temp_fit$time.series[,"remainder"]
fargo_top_soil_fit = fargo_top_soil_fit$time.series[,"remainder"]
# Selection of the variables
grand_bind_dis_top <- cbind(grand_discharge_fit, grand_top_soil_fit)
colnames(grand_bind_dis_top) <- c("discharge", "soil")
# Set up the analysis
grand_model <- VARselect(grand_bind_dis_top, lag.max = 12, type = "const")
grand_model$selection
grand_est <- VAR(grand_bind_dis_top, p = 6, type = "const", season = NULL,
exog = NULL)
summary(grand_est)
knitr::opts_chunk$set(echo = TRUE)
library(forcats)
library(lubridate)
library(ggplot2)
library(vars)
library(mFilter)
fargo <- read.csv("C:/Users/Luca/Desktop/SPRING2021/Statistical Research/Correct Dataset/fargo.csv", encoding="UTF-8")
grand <- read.csv("C:/Users/Luca/Desktop/SPRING2021/Statistical Research/Correct Dataset/grand.csv", encoding="UTF-8")
# Discharge
grand_discharge_ts <- ts(grand$discharge,
start = 2014,
end = 2020,
frequency = 365)
fargo_discharge_ts <- ts(fargo$discharge,
start = 2014,
end = 2020,
frequency = 365)
# Average Temperature
grand_temp_ts <- ts(grand$avg.temp,
start = 2014,
end = 2020,
frequency = 365)
fargo_temp_ts <- ts(fargo$avg.temp,
start = 2014,
end = 2020,
frequency = 365)
# Evapotranspiration
grand_pen_ts <- ts(grand$penman.pet,
start = 2014,
end = 2020,
frequency = 365)
fargo_pen_ts <- ts(fargo$penman.pet,
start = 2014,
end = 2020,
frequency = 365)
# Rainfall
grand_rainfall_ts <- ts(grand$rainfall,
start = 2014,
end = 2020,
frequency = 365)
fargo_rainfall_ts <- ts(fargo$rainfall,
start = 2014,
end = 2020,
frequency = 365)
# Snow Depth
grand_snow_ts <- ts(grand$snow.depth,
start = 2014,
end = 2020,
frequency = 365)
fargo_snow_ts <- ts(fargo$snow.depth,
start = 2014,
end = 2020,
frequency = 365)
# Top Soil temperature
grand_top_soil_ts <- ts(grand$top.soil.temp,
start = 2014,
end = 2020,
frequency = 365)
fargo_top_soil_ts <- ts(fargo$top.soil.temp,
start = 2014,
end = 2020,
frequency = 365)
plot(cbind(grand_discharge_ts,grand_top_soil_ts,grand_rainfall_ts), main = "Grand - Discharge and Top Soil temperature")
plot(cbind(fargo_discharge_ts,fargo_top_soil_ts,fargo_rainfall_ts), main = "Fargo - Discharge and Top Soil temperature")
grand_discharge_fit <- stl(grand_discharge_ts, s.window="period")
plot(grand_discharge_fit, main = "Grand Discharge Decomposition")
# Grand
grand_pen_fit <- stl(grand_pen_ts, s.window="period")
grand_rainfall_fit <- stl(grand_rainfall_ts, s.window="period")
grand_snow_fit <- stl(grand_snow_ts, s.window="period")
grand_temp_fit <- stl(grand_temp_ts, s.window="period")
grand_top_soil_fit <- stl(grand_top_soil_ts, s.window="period")
# Fargo
fargo_discharge_fit <- stl(fargo_discharge_ts, s.window="period")
fargo_pen_fit <- stl(fargo_pen_ts, s.window="period")
fargo_rainfall_fit <- stl(fargo_rainfall_ts, s.window="period")
fargo_snow_fit <- stl(fargo_snow_ts, s.window="period")
fargo_temp_fit <- stl(fargo_temp_ts, s.window="period")
fargo_top_soil_fit <- stl(fargo_top_soil_ts, s.window="period")
head(grand_discharge_fit$time.series)
plot(grand_discharge_fit$time.series[,"trend"])
acf(grand_discharge_fit$time.series[,"trend"])
plot(grand_discharge_fit$time.series[,"remainder"])
acf(grand_discharge_fit$time.series[,"remainder"])
# Grand
grand_discharge_fit = grand_discharge_fit$time.series[,"remainder"]
grand_pen_fit = grand_pen_fit$time.series[,"remainder"]
grand_rainfall_fit = grand_rainfall_fit$time.series[,"remainder"]
grand_snow_fit = grand_snow_fit$time.series[,"remainder"]
grand_temp_fit = grand_temp_fit$time.series[,"remainder"]
grand_top_soil_fit = grand_top_soil_fit$time.series[,"remainder"]
# Fargo
fargo_discharge_fit = fargo_discharge_fit$time.series[,"remainder"]
fargo_pen_fit = fargo_pen_fit$time.series[,"remainder"]
fargo_rainfall_fit = fargo_rainfall_fit$time.series[,"remainder"]
fargo_snow_fit = fargo_snow_fit$time.series[,"remainder"]
fargo_temp_fit = fargo_temp_fit$time.series[,"remainder"]
fargo_top_soil_fit = fargo_top_soil_fit$time.series[,"remainder"]
# Selection of the variables
grand_bind_dis_top <- cbind(grand_discharge_fit, grand_top_soil_fit)
colnames(grand_bind_dis_top) <- c("discharge", "soil")
# Set up the analysis
grand_model <- VARselect(grand_bind_dis_top, lag.max = 12, type = "const")
grand_model$selection
grand_est <- VAR(grand_bind_dis_top, p = 6, type = "const", season = NULL,
exog = NULL)
summary(grand_est)
grand_serial <- serial.test(grand_est, lags.pt = 12, type = "PT.asymptotic")
grand_serial
plot(grand_serial, names = "discharge")
plot(grand_serial, names = "soil")
grand_arch <- arch.test(grand_est, lags.multi = 12, multivariate.only = TRUE)
grand_arch
grand_norm <- normality.test(grand_est, multivariate.only = TRUE)
grand_norm
grand_cusum <- stability(grand_est, type = "OLS-CUSUM")
plot(grand_cusum)
grand_irf.int <- irf(grand_est, response = "int", n.ahead = 40, boot = TRUE)
grand_irf.int <- irf(grand_est, response = "discharge", n.ahead = 40, boot = TRUE)
plot(grand_irf.int)
